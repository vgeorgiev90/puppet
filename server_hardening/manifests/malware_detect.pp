class server_hardening::malware_detect(
) {

  exec { 'download-maldet':
    command => '/usr/bin/wget http://www.rfxn.com/downloads/maldetect-current.tar.gz',
    cwd     => '/root/',
  }

  exec { 'untar-maldet':
    command => '/usr/bin/tar -xzf maldetect-current.tar.gz',
    cwd     => '/root/',
  }

  exec { 'rename-maldet':
    command => '/usr/bin/mv /root/maldetect-*/ /root/maldet',
    cwd     => '/root/',
  }
 
  exec { 'install-maldet':
    command => '/root/maldet/install.sh',
    cwd     => '/root/maldet/',
  }
  
  exec { 'remove-source':
    command => '/usr/bin/rm /root/maldet -rf && /usr/bin/rm /root/maldetect-current.tar.gz -rf',
    cwd     => '/root/',
  }

  file { '/root/maldet-usage':
    ensure => file,
    owner  => 'root',
    content => "Usage: maldet -a /dir/to/scan \n to update maldet: maldet -u or maldet -d",
  }

  notify { 'malware detect installed': }
}

